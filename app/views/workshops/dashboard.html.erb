<!-- filepath: /home/mic/code/Mikke777/inspirationgathered/app/views/workshops/dashboard.html.erb -->
<div class="container my-5 p-5" style="background-color: #2836a5; border-radius: 25px;">
  <h1 class="mb-4" style="color: white;">My Workshops Dashboard</h1>

  <% @workshops.each do |workshop| %>
    <div class="card mb-4 p-3" style="border-radius: 15px;">
      <div class="row">
        <div class="col-12 col-md-2 d-flex align-items-center justify-content-center mb-3 mb-md-0" style="border-right: solid black;">
          <div class="bg-light p-3" style="border-radius: 10px;">
            <p class="font-weight-bold mb-0 fs-4"><%= workshop.date.strftime("%B") %></p>
            <p class="text-center mb-0 fs-3" style="border-top: solid black;"><%= workshop.date.strftime("%d") %></p>
          </div>
        </div>
        <div class="col-12 col-md-3 d-flex align-items-center mb-3 mb-md-0" style="border-right: solid black;">
          <div>
            <p class="card-text"><i class="fa-solid fa-clock"></i> <%= workshop.date.strftime("%H:%M") %></p>
            <p class="card-text"><i class="fa-solid fa-map-location-dot"></i> <%= workshop.address %></p>
            <%= link_to "Edit", edit_workshop_path(workshop), style: "color: black;" %>
          </div>
        </div>
        <div class="col-12 col-md-7">
          <h3 class="mt-3">Bookings</h3>
          <% if workshop.bookings.empty? %>
            <p class="text-muted">No bookings yet.</p>
          <% else %>
            <ul class="list-group">
              <% workshop.bookings.each do |booking| %>
                <li style="list-style :none;">
                  <div class="d-flex justify-content-between">
                    <div>
                      <p><strong>Booked by:</strong> <%= booking.user.name %></p>
                    </div>
                    <div>
                      <% if booking.messages.any? %>
                        <p><strong><i class="fa-solid fa-comment-sms"></i></strong> <%= booking.messages.count %></p>
                        <%= link_to 'View Chat', chat_workshop_booking_path(workshop, booking), style: "color: black;" %>
                      <% else %>
                        <p class="text-muted">No messages yet.</p>
                      <% end %>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
